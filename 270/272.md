设一个 $n$ 个节点的二叉树 tree 的中序遍历为 $(1,2,3,\ldots,n)$，其中数字 $1,2,3,\ldots,n$ 为节点编号。每个节点都有一个分数（均为正整数），记第 $j$ 个节点的分数为 $d_i，tree 及它的每个子树都有一个加分，任一棵子树 subtree（也包含 tree 本身）的加分计算方法如下：

subtree 的左子树的加分 $\times$ subtree 的右子树的加分 + subtree 的根的分数

若某个子树为主，规定其加分为 $1$，叶子的加分就是叶节点本身的分数。不考虑它的空子树。

试求一棵符合中序遍历为 $(1,2,3,\ldots,n)$ 且加分最高的二叉树 tree。

要求输出：
1. tree 的最高加分
2. tree 的前序遍历

### 输入格式

输入的第 $1$ 行是一个整数 $n(1\leq n < 30)$，为节点个数。

输入的第 $2$ 行是 $n$ 个用空格隔开的整数，为每个节点的分数（分数 $<100$）。

### 输出格式

输出的第 $1$ 行是一个整数，为最高加分（结果不会超过 $4\times 10^9$）。

输出的第 $2$ 行是 $n$ 个用空格隔开的整数，为该树的前序遍历。
